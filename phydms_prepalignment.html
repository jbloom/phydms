
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>the phydms_prepalignment program &#8212; phydms 2.3.7 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="the phydms_logoplot program" href="phydms_logoplot.html" />
    <link rel="prev" title="the phydms_comprehensive program" href="phydms_comprehensive_prog.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="the-phydms-prepalignment-program">
<span id="phydms-prepalignment-prog"></span><h1><a class="toc-backref" href="#id2">the <code class="docutils literal notranslate"><span class="pre">phydms_prepalignment</span></code> program</a><a class="headerlink" href="#the-phydms-prepalignment-program" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#the-phydms-prepalignment-program" id="id2">the <code class="docutils literal notranslate"><span class="pre">phydms_prepalignment</span></code> program</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id3">Overview</a></p></li>
<li><p><a class="reference internal" href="#command-line-usage" id="id4">Command-line usage</a></p>
<ul>
<li><p><a class="reference internal" href="#Positional Arguments" id="id5">Positional Arguments</a></p></li>
<li><p><a class="reference internal" href="#Named Arguments" id="id6">Named Arguments</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#examples" id="id7">Examples</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id3">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">phydms_prepalignment</span></code> is a program that is useful for preparing your sequence alignment for input to <code class="docutils literal notranslate"><span class="pre">phydms</span></code>.</p>
<p>It can help you make <strong>codon</strong>-level alignments from protein alignments of translated coding sequences. It also performs basic checks on sequences, and can remove overly diverged or similar sequences. The basic notion is that you have some reference sequence (presumably what you used for the deep mutational scanning), and want to get homologs aligned to that for analysis.</p>
<p>See below for information on <a class="reference internal" href="#command-line-usage">Command-line usage</a> and <a class="reference internal" href="#examples">Examples</a>.</p>
</div>
<div class="section" id="command-line-usage">
<h2><a class="toc-backref" href="#id4">Command-line usage</a><a class="headerlink" href="#command-line-usage" title="Permalink to this headline">¶</a></h2>
<p><p>Prepare alignment of protein-coding DNA sequences.</p>
<dl class="simple">
<dt>Steps:</dt><dd><ul class="simple">
<li><p>Any sequences specified by ‘–purgeseqs’ are removed.</p></li>
<li><p>Sequences not of length divisible by 3 are removed.</p></li>
<li><p>Sequences with ambiguous nucleotides are removed.</p></li>
<li><p>Sequences with non-terminal stop codons are removed;
terminal stop codons are trimmed.</p></li>
<li><p>Sequences that do not encode unique proteins are removed
unless they are specified for retention by ‘–keepseqs’.</p></li>
<li><p>A multiple sequence alignment is built using MAFFT.
This step is skipped if you specify ‘–prealigned’.</p></li>
<li><p>Sites gapped in reference sequence are stripped.</p></li>
<li><p>Sequences with too little protein identity to reference
sequence are removed, counting both mismatches and unstripped
gaps as differences. Identity cutoff set by ‘–minidentity’.</p></li>
<li><p>Sequences too similar to other sequences are removed. An
effort is made to keep one representative of sequences found
many times in input set. Uniqueness threshold set 
by ‘–minuniqueness’. You can specify sequences to not
remove via ‘–keepseqs’.</p></li>
<li><p>Problematic characters in header names are replaced by
underscores. This is any space, comma, colon, semicolon
parenthesis, bracket, single quote, or double quote.</p></li>
<li><p>An alignment is written, as well as a plot with same root
but extension ‘.pdf’ that shows divergence from reference
of all sequences retained and purged due to identity or
uniqueness.</p></li>
</ul>
</dd>
</dl>
<p>The ‘phydms’ package is written by the Bloom lab (see <a class="reference external" href="https://github.com/jbloomlab/phydms/contributors">https://github.com/jbloomlab/phydms/contributors</a>).
Version 2.3.7
Full documentation at <a class="reference external" href="http://jbloomlab.github.io/phydms">http://jbloomlab.github.io/phydms</a></p>
</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">phydms_prepalignment</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">prealigned</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">mafft</span> <span class="n">MAFFT</span><span class="p">]</span>
                            <span class="p">[</span><span class="o">--</span><span class="n">minidentity</span> <span class="n">MINIDENTITY</span><span class="p">]</span>
                            <span class="p">[</span><span class="o">--</span><span class="n">minuniqueness</span> <span class="n">MINUNIQUENESS</span><span class="p">]</span>
                            <span class="p">[</span><span class="o">--</span><span class="n">purgeseqs</span> <span class="p">[</span><span class="n">PURGESEQS</span> <span class="p">[</span><span class="n">PURGESEQS</span> <span class="o">...</span><span class="p">]]]</span>
                            <span class="p">[</span><span class="o">--</span><span class="n">keepseqs</span> <span class="p">[</span><span class="n">KEEPSEQS</span> <span class="p">[</span><span class="n">KEEPSEQS</span> <span class="o">...</span><span class="p">]]]</span> <span class="p">[</span><span class="o">-</span><span class="n">v</span><span class="p">]</span>
                            <span class="n">inseqs</span> <span class="n">alignment</span> <span class="n">refseq</span>
</pre></div>
</div>
<div class="section" id="Positional Arguments">
<h3><a class="toc-backref" href="#id5">Positional Arguments</a><a class="headerlink" href="#Positional Arguments" title="Permalink to this headline">¶</a></h3>
<dl class="option-list">
<dt><kbd>inseqs</kbd></dt>
<dd><p>FASTA file giving input coding sequences.</p>
</dd>
<dt><kbd>alignment</kbd></dt>
<dd><p>Name of created output FASTA alignment. PDF plot has same root, but extension ‘.pdf’.</p>
</dd>
<dt><kbd>refseq</kbd></dt>
<dd><p>Reference sequence in ‘inseqs’: specify substring found ONLY in header for that sequence.</p>
</dd>
</dl>
</div>
<div class="section" id="Named Arguments">
<h3><a class="toc-backref" href="#id6">Named Arguments</a><a class="headerlink" href="#Named Arguments" title="Permalink to this headline">¶</a></h3>
<dl class="option-list">
<dt><kbd>--prealigned</kbd></dt>
<dd><p>Sequences in ‘inseqs’ are already aligned, do NOT re-align.</p>
<p>Default: False</p>
</dd>
<dt><kbd>--mafft</kbd></dt>
<dd><p>Path to MAFFT (<a class="reference external" href="http://mafft.cbrc.jp/alignment/software/">http://mafft.cbrc.jp/alignment/software/</a>).</p>
<p>Default: “mafft”</p>
</dd>
<dt><kbd>--minidentity</kbd></dt>
<dd><p>Purge sequences with &lt;= this protein identity to ‘refseq’.</p>
<p>Default: 0.7</p>
</dd>
<dt><kbd>--minuniqueness</kbd></dt>
<dd><p>Require each sequence to have &gt;= this many protein differences relative to other sequences.</p>
<p>Default: 2</p>
</dd>
<dt><kbd>--purgeseqs</kbd></dt>
<dd><p>Specify sequences to always purge. Any sequences with any of the substrings specified here are always removed. The substrings can either be passed as repeated arguments here, or as the name of an existing file which has one substring per line.</p>
</dd>
<dt><kbd>--keepseqs</kbd></dt>
<dd><p>Do not purge any of these sequences for lack of identity or uniqueness. Specified in the same fashion as for ‘–purgeseqs’.</p>
</dd>
<dt><kbd>-v, --version</kbd></dt>
<dd><p>show program’s version number and exit</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="examples">
<h2><a class="toc-backref" href="#id7">Examples</a><a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Let’s say we have some unaligned homologous protein-coding sequences in <code class="docutils literal notranslate"><span class="pre">SUMO1_orthologs.fasta</span></code>. Let’s say we want to use as our reference sequence the human ortholog, which has the header <code class="docutils literal notranslate"><span class="pre">&gt;ENSP00000376077_Hsap/1-303</span></code> (note the <em>Hsap</em>, indicating <em>Homo sapiens</em>). We can build a codon alignment with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">phydms_prepalignment</span> <span class="n">SUMO1_orthologs</span><span class="o">.</span><span class="n">fasta</span> <span class="n">SUMO1_alignment</span><span class="o">.</span><span class="n">fasta</span> <span class="n">Hsap</span> <span class="o">--</span><span class="n">minidentity</span> <span class="mf">0.7</span> <span class="o">--</span><span class="n">minuniqueness</span> <span class="mi">2</span>
</pre></div>
</div>
<p>This creates the alignment <code class="docutils literal notranslate"><span class="pre">SUMO1_alignment.fasta</span></code> in which all gaps relative to the <em>Homo sapiens</em> orthologs are stripped, all sequences have at least 70% identity to the <em>Homo sapiens</em> ortholog, and all sequences have at least two protein differences from other retained homologs.</p>
<p>In addition to creating the alignment, the plot <code class="docutils literal notranslate"><span class="pre">SUMO1_alignment.pdf</span></code> is crated which shows the nucleotide and protein divergence from the reference <em>Homo sapiens</em> sequence of all homologs that passed the filters related to no premature stops, divisible by 3, and no stop codons. Here is that plot:</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="_images/SUMO1_alignment.jpg"><img alt="SUMO1_alignment.jpg" src="_images/SUMO1_alignment.jpg" style="width: 40%;" /></a>
<p class="caption"><span class="caption-text">A <code class="docutils literal notranslate"><span class="pre">jpg</span></code> version of the plot <code class="docutils literal notranslate"><span class="pre">SUMO1_alignment.pdf</span></code>.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>Sometimes there may be certain sequences you do <strong>not</strong> want to purge even if they lack uniqueness or identity to the reference sequence. For instance, maybe you want to keep the chimpanzee and gorilla homologs (which have <em>Panu</em> and <em>Ggor</em> in their headers) even though they are less than two amino-acid mutations from the human ortholog. In this case, use <code class="docutils literal notranslate"><span class="pre">--keepseqs</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">phydms_prepalignment</span> <span class="n">SUMO1_orthologs</span><span class="o">.</span><span class="n">fasta</span> <span class="n">SUMO1_alignment</span><span class="o">.</span><span class="n">fasta</span> <span class="n">Hsap</span> <span class="o">--</span><span class="n">minidentity</span> <span class="mf">0.7</span> <span class="o">--</span><span class="n">minuniqueness</span> <span class="mi">2</span> <span class="o">--</span><span class="n">keepseqs</span> <span class="n">Panu</span> <span class="n">Ggor</span>
</pre></div>
</div>
<p>If there are many such sequences, you can also list them in a file, such as <code class="docutils literal notranslate"><span class="pre">keepseqsfile.txt</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Panu</span>
<span class="n">Ggor</span>
</pre></div>
</div>
<p>and then specify this file to <code class="docutils literal notranslate"><span class="pre">--keepseqs</span></code> as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">phydms_prepalignment</span> <span class="n">SUMO1_orthologs</span><span class="o">.</span><span class="n">fasta</span> <span class="n">SUMO1_alignment</span><span class="o">.</span><span class="n">fasta</span> <span class="n">Hsap</span> <span class="o">--</span><span class="n">minidentity</span> <span class="mf">0.7</span> <span class="o">--</span><span class="n">minuniqueness</span> <span class="mi">2</span> <span class="o">--</span><span class="n">keepseqs</span> <span class="n">keepseqsfile</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>If there are sequences that you specifically want to exclude, you can do something similar with <code class="docutils literal notranslate"><span class="pre">--purgseqs</span></code>.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/BloomLogo.jpg" alt="Logo"/>
    
    <h1 class="logo logo-name">phydms</h1>
    
  </a>
</p>



<p class="blurb">Software for phylogenetic analyses informed by deep mutational scanning.</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=jbloomlab&repo=phydms&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a class="badge" href="https://travis-ci.org/jbloomlab/phydms">
    <img
        alt="https://secure.travis-ci.org/jbloomlab/phydms.svg?branch=master"
        src="https://secure.travis-ci.org/jbloomlab/phydms.svg?branch=master"
    />
</a>
</p>


<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="howtouse.html">how to use <code class="docutils literal notranslate"><span class="pre">phydms</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="phydms_prog.html">the <code class="docutils literal notranslate"><span class="pre">phydms</span></code> program</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="auxiliary_progs.html">auxiliary programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="ExpCM.html"><strong>Exp</strong>erimentally Informed <strong>C</strong>odon <strong>M</strong>odels</a></li>
<li class="toctree-l1"><a class="reference internal" href="implementation.html">Numerical implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html"><code class="docutils literal notranslate"><span class="pre">phydmslib</span></code> API</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgments.html">Acknowledgments and citations</a></li>
<li class="toctree-l1"><a class="reference internal" href="indices_and_tables.html">Indices and tables</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="auxiliary_progs.html">auxiliary programs</a><ul>
      <li>Previous: <a href="phydms_comprehensive_prog.html" title="previous chapter">the <code class="docutils literal notranslate"><span class="pre">phydms_comprehensive</span></code> program</a></li>
      <li>Next: <a href="phydms_logoplot.html" title="next chapter">the <code class="docutils literal notranslate"><span class="pre">phydms_logoplot</span></code> program</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015-2020, Sarah Hilton and Jesse Bloom.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/phydms_prepalignment.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/jbloomlab/phydms" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>